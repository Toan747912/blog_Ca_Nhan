{{ define "main" }}
<div class="max-w-6xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
    
    <!-- Tiêu đề trang -->
    <h1 class="text-4xl font-bold text-gray-900 dark:text-white tracking-tight text-center">
        Blog Lập Trình
    </h1>
    <!-- <p class="mt-4 text-xl text-gray-600 dark:text-gray-300 text-center">
        Các bài chia sẻ về Java, JavaScript và Lập trình Mạng.
    </p> -->

    <!-- Khu vực lọc theo Category -->
    <div class="mt-12 mb-8 p-6 bg-white/30 dark:bg-dark-card/40 backdrop-blur-lg border border-white/50 dark:border-dark-border rounded-2xl shadow-lg">
        <h3 class="text-lg font-semibold text-center mb-4 text-gray-800 dark:text-dark-text-primary">Lọc bài viết theo chủ đề</h3>
        <div class="flex flex-wrap justify-center gap-3">
            <!-- Nút "Tất cả" - Chuyển thành button -->
            <button data-filter="all" class="filter-btn active-filter bg-blue-600 text-white text-sm font-medium px-4 py-2 rounded-full transition duration-200 ease-in-out hover:scale-105">
                Tất cả
            </button>
            <!-- Lặp qua tất cả các category của site - Chuyển thành button -->
            {{ range .Site.Taxonomies.categories.ByCount }}
                <button data-filter="{{ .Page.Title | urlize }}" class="filter-btn bg-blue-100/70 text-blue-900 text-sm font-medium px-4 py-2 rounded-full dark:bg-blue-900/70 dark:text-blue-200 transition duration-200 ease-in-out hover:scale-105 hover:bg-blue-200 dark:hover:bg-blue-800">
                    {{ .Page.Title }} <span class="ml-1 opacity-75">({{ .Count }})</span>
                </button>
            {{ end }}
        </div>
    </div>

    <!-- Vùng chứa thông báo và danh sách bài viết -->
    <div id="posts-container" class="mt-12">
        <!-- Thông báo không tìm thấy bài viết (ẩn mặc định) -->
        <div id="no-results-message" class="hidden text-center py-12">
            <p class="text-2xl font-semibold text-gray-700 dark:text-gray-300">Không tìm thấy bài viết nào</p>
            <p class="mt-2 text-gray-500 dark:text-gray-400">Vui lòng thử chọn một chủ đề khác.</p>
        </div>

        <!-- Lưới bài viết -->
        <div id="posts-grid" class="grid grid-cols-1 md:grid-cols-2 gap-10">
            {{ range .Pages.ByDate.Reverse }}
                {{ .Render "summary" }}
            {{ end }}
        </div>
    </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const postCards = document.querySelectorAll('.post-card');
    const postsGrid = document.getElementById('posts-grid');
    const noResultsMessage = document.getElementById('no-results-message');

    // CSS classes for button states
    const activeClasses = ['active-filter', 'bg-blue-600', 'text-white'];
    const inactiveClasses = ['bg-blue-100/70', 'text-blue-900', 'dark:bg-blue-900/70', 'dark:text-blue-200', 'hover:bg-blue-200', 'dark:hover:bg-blue-800'];
    const activeInactiveClasses = ['bg-blue-100/70', 'text-blue-900', 'dark:bg-blue-900/70', 'dark:text-blue-200', 'hover:bg-blue-200', 'dark:hover:bg-blue-800'];

    filterButtons.forEach(button => {
        button.addEventListener('click', function () {
            const filter = this.dataset.filter;
            let visibleCount = 0;

            // Update button styles
            filterButtons.forEach(btn => {
                btn.classList.remove(...activeClasses);
                btn.classList.add(...inactiveClasses);
            });
            this.classList.add(...activeClasses);
            this.classList.remove(...activeInactiveClasses);

            // Filter cards
            postCards.forEach(card => {
                const categories = card.dataset.categories || '';
                const hasCategory = categories.split(' ').includes(filter);

                if (filter === 'all' || hasCategory) {
                    card.style.display = 'flex';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });

            // Show or hide the 'no results' message
            if (visibleCount === 0) {
                postsGrid.classList.add('hidden');
                noResultsMessage.classList.remove('hidden');
            } else {
                postsGrid.classList.remove('hidden');
                noResultsMessage.classList.add('hidden');
            }
        });
    });
});
</script>
{{ end }}